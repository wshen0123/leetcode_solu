class Solution:
    # @param {character[][]} matrix
    # @return {integer}
    def maximalSquare(self, matrix):
        
        if not matrix:
            return 0
            
        m = len(matrix)
        n = len(matrix[0])
        
        matrix = [list(map(int, row)) for row in matrix]
        
        dp = [[0] * n for i in range(m)] # max square-length ending in [i][j]
        
        for i in range(m):
            for j in range(n):
                if matrix[i][j] == 0:
                    dp[i][j] = 0
                    continue
                
                if i-1 < 0 or j-1 < 0: # along boarder
                    dp[i][j] = matrix[i][j]
                    continue
                
                length = dp[i-1][j-1]
                if length == 0: # no pre-square
                    dp[i][j] = matrix[i][j]
                    continue

                for k in range(1, length + 1):
                    if matrix[i-k][j] != 1 or matrix[i][j-k] != 1:
                        dp[i][j] = k*matrix[i][j]
                        break
                else:                
                    dp[i][j] = length + 1
        
        max_length = max([dp[i][j] for i in range(m) for j in range(n)])
        return max_length * max_length

if __name__ == "__main__":
    matrix=["1111111111111101001111111100111011111111","1111011011111111101101111101111111111111","0111101011111101101101101111111111111111","0101101011111111111101111111010110111111","1111111111110111110110010111111111111111","1111111110110101111111111101011111101111","0110110101110011111111111111110111110101","0111111111111100111111100110011011010101","1111011110111111111011011011110101101011","1111111110111111111101101101110111101111","1110110011111111111100111111111111111111","1011111110111101111001110111111111111111","0110111111111111101111110111011111011111","1111111111111111011111111111110111111011","1111100111111110101100111111111111101111","1111101111111110111111011111111111011111","1111101111111111111111011001111110011111","1111110111111111011111111111110111110111","1011111111111111010111110010111110111111","1111110011111111111110111111111111111011","1111111111111111110111011111011111011011","1100011011111111111111011111011111111111","1111101011111111111101100101110011111111","1110010111111111111011011110111101111101","1111111111111101101111111111101111111111","1111111011111101111011111111111110111111","1110011111111110111011111111110111110111","1111111111111100111111010111111111110111","1111111111111111111111000111111111011101","1111110111111111111111111101100111011011","1111011011111101101101111110111111101111","1111111111011111111111111111111111111111","1111111111111111111111111111111111111111","1100011111111110111111111111101111111011","1111101111111101111010111111111111111111","0111111111110011111111110101011011111111","1011011111101111111111101111111111110011","1010111111111111111111111111111110011111","0111101111011111111111111111110111111111","0111111011111111011101111011101111111111","0111111111110101111011111101011001111011","1111111111111011110111111101111111101110","1111101111111100111111111110111111001111","1101101111110101111101111111100111010100","0110111111100111110010111110111011011101"]
    solu = Solution()
    print(solu.maximalSquare(matrix))
